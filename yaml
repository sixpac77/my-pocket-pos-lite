- - name: Build debug APK
        env:
          JAVA_HOME: /usr/lib/jvm/java-17-openjdk-amd64
          ANDROID_SDK_ROOT: ${{ github.workspace }}/.buildozer/android/platform/android-sdk
        run: |
          set -e
          export PATH=$PATH:~/.local/bin

          # 1) First run to initialize Buildozer
          buildozer android debug || true

          # 2) Accept licenses and install correct build-tools
          SDKMAN="$ANDROID_SDK_ROOT/cmdline-tools/latest/bin/sdkmanager"
          yes | "$SDKMAN" --licenses
          yes | "$SDKMAN" "platforms;android-34" "platform-tools" "build-tools;34.0.0"

          # 3) Force PATH to correct version
          export PATH="$ANDROID_SDK_ROOT/build-tools/34.0.0:$PATH"

          # 4) Run final build
          buildozer android debug
